PS D:\Documents\CODE_WITH_ERICADESHH\GitHub\ML & AI\Karatina-University-Final-Year-Project\F.N.D-Project-Codebase\FND-Backend-Pro> & C:/Users/HP/AppData/Local/Programs/Python/Python310/python.exe "d:/Documents/CODE_WITH_ERICADESHH/GitHub/ML & AI/Karatina-University-Final-Year-Project/F.N.D-Project-Codebase/FND-Backend-Pro/FND-Model.py"
3;C2025-04-05 03:35:52.861923: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly differe
nt numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-05 03:35:54.393203: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.

Fake News Dataset Shape: (23481, 5)

Fake News Dataset Columns: ['title', 'text', 'subject', 'date', 'label']

Fake News Dataset Info:
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 23481 entries, 0 to 23480
Data columns (total 5 columns):
 #   Column   Non-Null Count  Dtype 
---  ------   --------------  ----- 
 0   title    23481 non-null  object
 1   text     23481 non-null  object
 2   subject  23481 non-null  object
 3   date     23481 non-null  object
 4   label    23481 non-null  object
dtypes: object(5)
memory usage: 917.4+ KB
None

Fake News Sample:
                                               title  ... label
0   Donald Trump Sends Out Embarrassing New Year’...  ...  fake
1   Drunk Bragging Trump Staffer Started Russian ...  ...  fake

[2 rows x 5 columns]

True News Dataset Shape: (21417, 5)

True News Dataset Columns: ['title', 'text', 'subject', 'date', 'label']

True News Dataset Info:
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 21417 entries, 0 to 21416
Data columns (total 5 columns):
 #   Column   Non-Null Count  Dtype
---  ------   --------------  -----
 0   title    21417 non-null  object
 1   text     21417 non-null  object
 2   subject  21417 non-null  object
 3   date     21417 non-null  object
 4   label    21417 non-null  object
dtypes: object(5)
memory usage: 836.7+ KB
None

True News Sample:
                                               title  ... label
0  As U.S. budget fight looms, Republicans flip t...  ...  true
1  U.S. military to accept transgender recruits o...  ...  true

[2 rows x 5 columns]

Cleaning and preprocessing Fake News data...

Cleaning and preprocessing True News data...

Processing missing values...

=== HANDLING MISSING VALUES IN FAKE NEWS ===

Original missing values:
date     11613
year     11613
month    11613
dtype: int64

Found 11613 missing dates - filling with placeholder values

After handling missing values:
No missing values remaining

=== HANDLING MISSING VALUES IN TRUE NEWS ===

Original missing values:
No missing values found

After handling missing values:
No missing values remaining

Missing Values in Fake News:
title                0
text                 0
subject              0
date                 0
label                0
full_text            0
cleaned_text         0
text_length          0
word_count           0
char_count           0
avg_word_length      0
exclamation_count    0
question_count       0
uppercase_ratio      0
year                 0
month                0
dtype: int64

Missing Values in True News:
title                0
text                 0
subject              0
date                 0
label                0
full_text            0
cleaned_text         0
text_length          0
word_count           0
char_count           0
avg_word_length      0
exclamation_count    0
question_count       0
uppercase_ratio      0
year                 0
month                0
dtype: int64

=== PROCESSING FAKE NEWS DATASET ===

Processing Fake News dataset...

Removing outliers in column: text_length
Iteration 1: Removing 312 outliers
Iteration 2: Removing 456 outliers
Iteration 3: Removing 210 outliers
Iteration 4: Removing 75 outliers
Iteration 5: Removing 22 outliers
Iteration 6: Removing 8 outliers
Iteration 7: Removing 5 outliers
Iteration 8: Removing 2 outliers
No more outliers detected in text_length after 8 iterations

Removing outliers in column: word_count
Iteration 1: Removing 36 outliers
Iteration 2: Removing 10 outliers
Iteration 3: Removing 4 outliers
No more outliers detected in word_count after 3 iterations

Final verification:
Remaining outliers in text_length: 12 (should be 0)
Remaining outliers in word_count: 0 (should be 0)

Original shape: (23481, 16)
Cleaned shape: (22341, 16)
Percentage removed: 4.85%

=== PROCESSING TRUE NEWS DATASET ===

Processing True News dataset...

Removing outliers in column: text_length
Iteration 1: Removing 151 outliers
Iteration 2: Removing 74 outliers
Iteration 3: Removing 18 outliers
Iteration 4: Removing 4 outliers
Iteration 5: Removing 1 outliers
Iteration 6: Removing 1 outliers
No more outliers detected in text_length after 6 iterations

Removing outliers in column: word_count
Iteration 1: Removing 29 outliers
Iteration 2: Removing 9 outliers
Iteration 3: Removing 2 outliers
No more outliers detected in word_count after 3 iterations

Final verification:
Remaining outliers in text_length: 5 (should be 0)
Remaining outliers in word_count: 0 (should be 0)

Original shape: (21417, 16)
Cleaned shape: (21128, 16)
Percentage removed: 1.35%

Performing EDA for Fake News dataset...

Performing EDA for True News dataset...

Feature Analysis for Fake News:

Numeric Features Summary:
        text_length    word_count    char_count  ...  uppercase_ratio          year         month
count  22341.000000  22341.000000  22341.000000  ...     22341.000000  22341.000000  22341.000000
mean    2249.950718    374.407054   2249.950718  ...         0.073617   1023.558614      2.827895
std     1205.997582    200.253683   1205.997582  ...         0.078426   1008.075676      3.606478
min       31.000000      2.000000     31.000000  ...         0.000000      0.000000      0.000000
25%     1474.000000    244.000000   1474.000000  ...         0.039153      0.000000      0.000000
50%     2194.000000    368.000000   2194.000000  ...         0.050195   2015.000000      1.000000
75%     2967.000000    494.000000   2967.000000  ...         0.071429   2016.000000      5.000000
max     5903.000000    975.000000   5903.000000  ...         0.852941   2017.000000     12.000000

[8 rows x 9 columns]

Feature Analysis for True News:

Numeric Features Summary:
        text_length    word_count    char_count  ...  uppercase_ratio          year         month
count  21128.000000  21128.000000  21128.000000  ...     21128.000000  21128.000000  21128.000000
mean    2370.320949    382.773997   2370.320949  ...         0.042140   2016.780954      8.249337
std     1529.530972    248.107724   1529.530972  ...         0.015080      0.413610      3.341319
min       32.000000      4.000000     32.000000  ...         0.010417   2016.000000      1.000000
25%      956.500000    155.000000    956.500000  ...         0.032104   2017.000000      6.000000
50%     2262.000000    365.000000   2262.000000  ...         0.038628   2017.000000      9.000000
75%     3221.000000    522.000000   3221.000000  ...         0.048193   2017.000000     11.000000
max     6993.000000   1126.000000   6993.000000  ...         0.220386   2017.000000     12.000000

[8 rows x 9 columns]

Training new model...

=== CLASS DISTRIBUTION ANALYSIS ===

Original Class Distribution:
label
fake    22341
true    21128
Name: count, dtype: int64

Training Set Class Distribution:
0    17873
1    16902
Name: count, dtype: int64

Test Set Class Distribution:
0    4468
1    4226
Name: count, dtype: int64

Imbalance detected (ratio: 1.06). Applying SMOTE...

After SMOTE Class Distribution:
0    17873
1    17873
Name: count, dtype: int64

Training optimized LSTM model...
Epoch 1/8
252/252 ━━━━━━━━━━━━━━━━━━━━ 95s 309ms/step - accuracy: 0.8617 - loss: 0.3085 - val_accuracy: 0.8694 - val_loss: 0.3706
Epoch 2/8
252/252 ━━━━━━━━━━━━━━━━━━━━ 73s 288ms/step - accuracy: 0.9903 - loss: 0.0348 - val_accuracy: 0.9032 - val_loss: 0.2895
Epoch 3/8
252/252 ━━━━━━━━━━━━━━━━━━━━ 72s 287ms/step - accuracy: 0.9940 - loss: 0.0220 - val_accuracy: 0.9278 - val_loss: 0.2134
Epoch 4/8
252/252 ━━━━━━━━━━━━━━━━━━━━ 97s 384ms/step - accuracy: 0.9966 - loss: 0.0145 - val_accuracy: 0.9105 - val_loss: 0.3422

Model and tokenizer saved successfully

Model Evaluation:
272/272 ━━━━━━━━━━━━━━━━━━━━ 20s 71ms/step
              precision    recall  f1-score   support

        fake       0.99      0.98      0.99      4468
        true       0.98      0.99      0.98      4226

    accuracy                           0.99      8694
   macro avg       0.99      0.99      0.99      8694
weighted avg       0.99      0.99      0.99      8694


Model Evaluation:
272/272 ━━━━━━━━━━━━━━━━━━━━ 19s 69ms/step 
              precision    recall  f1-score   support

        fake       0.99      0.98      0.99      4468
        true       0.98      0.99      0.98      4226

    accuracy                           0.99      8694
   macro avg       0.99      0.99      0.99      8694
weighted avg       0.99      0.99      0.99      8694


Feature Importance Analysis:

Top 20 words predicting TRUE news:
['reuters', 'said', 'on', 'trumps', 'washington', 'us', 'in', 'republican', 'wednesday', 'its', 'thursday', 'tuesday', 'friday', 'nov', 'minister', 'edt', 'reporters', 'dont', 'presidential', 'clintons']

Top 20 words predicting FAKE news:
['video', 'via', 'this', 'just', 'that', 're', 'gop', 'obama', 'is', 'hillary', 'america', 'breaking', 'image', 'mr', 'you', 
'wire', 'didn', 'watch', 'american', '21st']

Model Evaluation Metrics:
              precision    recall  f1-score   support

        fake       0.99      0.98      0.99      4468
        true       0.98      0.99      0.98      4226

    accuracy                           0.99      8694
   macro avg       0.99      0.99      0.99      8694
weighted avg       0.99      0.99      0.99      8694


Final Model Accuracy: 0.9852
==================================================

Loaded pre-trained model and tokenizer

==================================================
FAKE NEWS DETECTION INTERACTIVE MODE
==================================================
Enter news articles to check if they're fake or true
Type 'quit' or 'exit' to end the session

Enter news text or headline (or 'quit' to exit):